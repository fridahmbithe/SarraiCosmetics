(()=>{var{__:e}=wp.i18n,t={calculateEventPosition:(e,t)=>{if("viewport"===t){return{top:e.target.getBoundingClientRect().top,left:e.target.getBoundingClientRect().left,right:e.target.getBoundingClientRect().right,bottom:e.target.getBoundingClientRect().bottom,width:e.target.getBoundingClientRect().width,height:e.target.getBoundingClientRect().height}}if("body"===t){let t=function(e){var t=0;do{isNaN(e.offsetLeft)||(t+=e.offsetLeft)}while(e=e.offsetParent);return t},n=function(e){var t=0;do{isNaN(e.offsetRight)||(t+=e.offsetRight)}while(e=e.offsetParent);return t},i=function(e){var t=0;do{isNaN(e.offsetBottom)||(t+=e.offsetBottom)}while(e=e.offsetParent);return t};return{top:function(e){var t=0;do{isNaN(e.offsetTop)||(t+=e.offsetTop)}while(e=e.offsetParent);return t}(e.target),left:t(e.target),right:n(e.target),bottom:i(e.target),width:e.target.getBoundingClientRect().width,height:e.target.getBoundingClientRect().height}}},insertContextMenu:(e,t)=>{wp.data.dispatch("getgenie").setContextMenu({open:t,buttonEvent:{top:e.top,left:e.left,right:e.right,bottom:e.bottom,width:e.width,height:e.height}})},showSidebar:e=>{let t=wp.data.select("getgenie").sidebar().existingInputValue||"",n="WriteTemplatesScreen",i=t.split(/[.!?]+\s/).filter(Boolean).length,r=e.slug;"re-write"===r?r=i>1?"paragraph-rewriter":"sentence-rewriter":"list"===r&&(n="TemplateListScreen"),wp.data.dispatch("getgenie").setContextMenu({open:!1}),wp.data.dispatch("getgenie").setSidebar({open:!0,currentWritingMode:e?.mode,component:n,currentTemplate:r,existingInputValue:t.replace(/<br\s*[\/]?>/g,"")})}};jQuery(document).ready((function(e){const n=(e,t)=>{const n=e.replace(/<br\s*[\/]?>/g,"\n");["INPUT","TEXTAREA"].includes(t?.tagName)?t.value=n:"expandOutline"===wp.data.select("getgenie").sidebar().currentTemplate?t.insertAdjacentHTML("afterend",`<p>${n}</p>`):t.innerText=n;const i=new Event("input",{bubbles:!0,cancelable:!0});t.dispatchEvent(i)},i=(e,t="getgenie-trigger-btn-textarea",n=!0)=>{const i=!0===n?jQuery(e).find("textarea"):jQuery(e),r=`${window.getGenie.config.assetsUrl}dist/admin/images/genie-dark.svg`;i.parent().append(`<button class="getgenie-trigger-btn ${t}"><img src=${r} alt="GetGenie" /></button>`)};document.getElementById("post-body")?(i(document.getElementById("post-body")),i(document.getElementById("title"),"getgenie-trigger-btn-text",!1)):i(document),jQuery(document).on("click",".getgenie-trigger-btn",(function(e){e.preventDefault();let i=jQuery(this).siblings(["textarea","input[type=text]"]);if(0==i.length)return;let r=i[0]?.value;"INPUT"!==i[0]?.tagName&&"TEXTAREA"!==i[0]?.tagName&&(r=i[1]?.value,i=[i[1]]),i=i?.[0];let o,a,g=(r||"").substring(0,i?.selectionStart),s=(r||"").substring(i?.selectionEnd),l=window.getSelection(),d=l.toString(),c=jQuery(this).parents("#wp-content-editor-container");if(c.length>0&&"none"===c.find("textarea").css("display")){const e=document.querySelector("#content_ifr").contentWindow,t=e.document,n=t.querySelector("body p");if(l=e.document.getSelection(),d=l.toString(),l?.focusNode&&(i=l.focusNode.parentNode,r=i.innerText,o=Math.min(l?.focusOffset,l?.baseOffset),a=Math.max(l?.focusOffset,l?.baseOffset),g=r.substring(0,o),s=r.substring(a)),!n){let e=t.createElement("p");return e.innerText=r,void t.querySelector("body").appendChild(e)}}let u=t.calculateEventPosition(e,"body");t.insertContextMenu(u,!wp.data.select("getgenie").contextMenu().open,d),l?.focusNode&&(wp.data.dispatch("getgenie").setSidebar({insertTextCallback:n,insertTextField:i,existingInputValue:d}),wp.data.dispatch("getgenie").setContextMenu({inputContent:{beforeCaret:g,selectedText:d,afterCaret:s},insertionField:i,contextMenuCallback:{continueWriting:(e,t,{beforeCaret:i,selectedText:r})=>{let o=e;" "!==r[r?.length-1]&&(o=" "+o),n(i+r+o,t)},expandOutline:(e,t,{beforeCaret:i,selectedText:r})=>{n(i+r+"\n"+e,t)},rewrite:(e,t,{beforeCaret:i,afterCaret:r})=>{let o=i;i&&(o+=" "),o+=e+" "+r,n(o,t)}}}))}))}))})();